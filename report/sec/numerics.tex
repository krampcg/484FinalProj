\documentclass[../main.tex]{subfiles}

\begin{document}

\subsection{A Test Problem}
In this section we derive and evaluate a number of common numerical schemes for the solution of a test problem: the wave equation in one dimensions
\begin{gather}\label{eq:wave}
    \frac{\partial^2 u}{\partial t^2} = c^2\frac{\partial^2 u}{\partial x^2}\qquad\text{for }(x)\in V,
\end{gather}
where $c$ denotes the propagation speed, and $\Omega$ denotes the interior of our spatial domain. For this equation, we consider homogenous Dirchlet boundary conditions
\begin{gather}\label{eq:bcs}
    u(t,x) = 0\qquad\text{for }x\in A,
\end{gather}
where $\partial\Omega$ denotes the exterior of our spatial domain. Finally, we also consider some initial condition
\begin{gather}\label{eq:ic}
    u(t,x,y) = f(x,y)\qquad\text{for }t=t_0.
\end{gather}
The equation \ref{eq:shallow}  that we plan to numerically solve is very similar to this equation, as both are linear second-order hyperbolic partial differential equations. Further, we will be using the same boundary and initial conditions. Because of this, we select the scheme that we find to be optimal in terms of both time and accuracy.

\noindent However, we first state \label{eq:wave} in \noindent{conservative form}. To do this we define variables $\alpha$ and $\gamma$ such that:
\begin{gather*}
    \left.
    \begin{aligned}
        \gamma &= \frac{\partial u}{\partial t},\\
        \alpha &= c\frac{\partial u}{\partial x}.
    \end{aligned}
    \right\}
    \Rightarrow
    \mathbf{U} = \begin{bmatrix} \gamma \\ \alpha\end{bmatrix}
\end{gather*}
Now, we take derivatives with respect to time obtain a coupled system of equations:
\begin{gather*}
    \begin{aligned}
        \frac{\partial \gamma}{\partial t} &= \frac{\partial^2 u}{\partial t^2} = \frac{\partial}{\partial x}\left( c^2 \frac{\partial u}{\partial x}\right) = c^2 \frac{\partial \alpha}{\partial x}\\
        \frac{\partial \alpha}{\partial t} &= \frac{\partial^2 u}{\partial t \partial x} = \frac{\partial^2 u}{\partial x \partial t} = \frac{\partial \gamma}{\partial x}
    \end{aligned}
\end{gather*}
We may write this in matrix form by:
\begin{gather*}
\frac{\partial }{\partial t}
\begin{bmatrix}
\alpha \\ \gamma
\end{bmatrix}
+
\begin{bmatrix}
\partial_x & 0\\
0 & \partial_x 
\end{bmatrix}
\left(
\begin{bmatrix}
0 & -c\\
-c & 0
\end{bmatrix}
\begin{bmatrix}
\alpha \\
\gamma
\end{bmatrix}
\right)
=
\mathbf{0},
\end{gather*}

\subsection{The Lax-Wendroff Scheme}

The Lax-Wendroff scheme \cite{rezzolla} is a combination of the Lax-Friedrichs scheme and the leapfrog scheme. First, the half-steps must be computed as below:

\begin{gather}
	u^{n+1/2}_{j\pm1/2} = \frac{1}{2}(u^{n}_{j}+u^{n}_{j\pm1}) \mp \frac{\alpha}{2}(u^{n}_{j\pm1}-u^{n}_j).
\end{gather}

\noindent These are then used in the computation of a leapfrog half-step:

\begin{gather}
	u^{n+1}_{j} = u^{n}_{j}-\alpha(u^{n+1/2}_{j+1/2}-u^{n+1/2}_{j-1/2}).
\end{gather}

\noindent Substitution then yields the numerical scheme as it was implemented in our program:

\begin{gather}
	u^{n+1}_{j} = u^n_j - \frac{\alpha}{2}(u^{n}_{j+1}-u^n_{j-1}) + \frac{\alpha^2}{2}(u^{n}_{j+1}-2u^n_j+u^n_{j-1}).
\end{gather}

\subsubsection{Boundary Conditions}

Our first implementation of Lax-Wendroff applied to the wave equation implemented Dirichlet boundary conditions, with the solution at the endpoints being set to $0$. This caused numerical instability in the solution which worsened as the number of time steps used in the discretization increased.

Our solution to this was to implement Sommerfeld boundary conditions (also called radiative boundary conditions). These boundary conditions allow the wave to freely move out of our system when it reaches the boundary by applying a numerical scheme for basic advection. The following numerical scheme was implemented to allow the waves to advect from the system:

\begin{gather}
	u^{n+1}_{j+1} = u^n_j - u^{n+1}_jQ+u^n_{j+1}Q	
\end{gather}

\noindent for the outer (positive x) edge and 

\begin{gather}
	u^{n+1}_j = u^n_{j+1}-u^{n+1}_{j+1}Q+u^n_jQ
\end{gather}

\noindent for the inner (negative x) edge, where 

\begin{gather}
	Q = \frac{(1-\alpha)}{(1+\alpha)}.
\end{gather}


\end{document}
